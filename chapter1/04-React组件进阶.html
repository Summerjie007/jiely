<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>React组件进阶 | react 快速上手</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="shortcut icon" type="image/x-icon" href="./images/favicon.ico">
    <meta name="description" content="杰哥哥前端研究院">
    
    <link rel="preload" href="/jiely/assets/css/0.styles.5afc0e25.css" as="style"><link rel="preload" href="/jiely/assets/js/app.77e16281.js" as="script"><link rel="preload" href="/jiely/assets/js/3.23c74d3c.js" as="script"><link rel="preload" href="/jiely/assets/js/5.8a58ce3d.js" as="script"><link rel="prefetch" href="/jiely/assets/js/10.7a1d5359.js"><link rel="prefetch" href="/jiely/assets/js/11.825d4d37.js"><link rel="prefetch" href="/jiely/assets/js/12.34a617ee.js"><link rel="prefetch" href="/jiely/assets/js/13.e956d670.js"><link rel="prefetch" href="/jiely/assets/js/14.24f14c4e.js"><link rel="prefetch" href="/jiely/assets/js/15.145280c2.js"><link rel="prefetch" href="/jiely/assets/js/16.8aed0633.js"><link rel="prefetch" href="/jiely/assets/js/17.55a0e136.js"><link rel="prefetch" href="/jiely/assets/js/18.6663a467.js"><link rel="prefetch" href="/jiely/assets/js/19.1d02f7a7.js"><link rel="prefetch" href="/jiely/assets/js/2.a217f65b.js"><link rel="prefetch" href="/jiely/assets/js/20.402bbfbb.js"><link rel="prefetch" href="/jiely/assets/js/21.13ffb241.js"><link rel="prefetch" href="/jiely/assets/js/22.9baa51a1.js"><link rel="prefetch" href="/jiely/assets/js/23.8b2d09f5.js"><link rel="prefetch" href="/jiely/assets/js/24.88446b74.js"><link rel="prefetch" href="/jiely/assets/js/25.212136bd.js"><link rel="prefetch" href="/jiely/assets/js/26.ab4c3f14.js"><link rel="prefetch" href="/jiely/assets/js/27.72b6ee76.js"><link rel="prefetch" href="/jiely/assets/js/28.7a75f195.js"><link rel="prefetch" href="/jiely/assets/js/29.20892189.js"><link rel="prefetch" href="/jiely/assets/js/30.7e88f712.js"><link rel="prefetch" href="/jiely/assets/js/31.dd681bb1.js"><link rel="prefetch" href="/jiely/assets/js/32.56daaef6.js"><link rel="prefetch" href="/jiely/assets/js/33.6a8234af.js"><link rel="prefetch" href="/jiely/assets/js/34.e75e2562.js"><link rel="prefetch" href="/jiely/assets/js/35.d15b5258.js"><link rel="prefetch" href="/jiely/assets/js/36.f706c7a4.js"><link rel="prefetch" href="/jiely/assets/js/37.02d520ec.js"><link rel="prefetch" href="/jiely/assets/js/38.3f565c1d.js"><link rel="prefetch" href="/jiely/assets/js/39.aac2a5de.js"><link rel="prefetch" href="/jiely/assets/js/4.8fe307c4.js"><link rel="prefetch" href="/jiely/assets/js/40.6ebf4f70.js"><link rel="prefetch" href="/jiely/assets/js/41.80e54647.js"><link rel="prefetch" href="/jiely/assets/js/42.b09ba0a7.js"><link rel="prefetch" href="/jiely/assets/js/43.4f1aa9ba.js"><link rel="prefetch" href="/jiely/assets/js/44.81f24246.js"><link rel="prefetch" href="/jiely/assets/js/45.b1f0b963.js"><link rel="prefetch" href="/jiely/assets/js/46.d01ff1ff.js"><link rel="prefetch" href="/jiely/assets/js/47.09ac9b9d.js"><link rel="prefetch" href="/jiely/assets/js/48.7c874e95.js"><link rel="prefetch" href="/jiely/assets/js/49.0931d234.js"><link rel="prefetch" href="/jiely/assets/js/6.9b54027d.js"><link rel="prefetch" href="/jiely/assets/js/7.f308a72a.js"><link rel="prefetch" href="/jiely/assets/js/8.a7efc970.js"><link rel="prefetch" href="/jiely/assets/js/9.1f369830.js">
    <link rel="stylesheet" href="/jiely/assets/css/0.styles.5afc0e25.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/jiely/" class="home-link router-link-active"><img src="/jiely/images/logo.jpg" alt="react 快速上手" class="logo"> <span class="site-name can-hide">react 快速上手</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://juejin.cn/post/7097067108663558151" target="_blank" rel="noopener noreferrer" class="nav-link external">
  50+Vue经典面试题源码级
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://segmentfault.com/a/1190000018604138" target="_blank" rel="noopener noreferrer" class="nav-link external">
  react面试题
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://juejin.cn/post/6844904055840440334" target="_blank" rel="noopener noreferrer" class="nav-link external">
  从零React项目
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://summerjie007.github.io/vue3_study/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue3+TS
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/airbnb/javascript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  代码规范
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://juejin.cn/post/7097067108663558151" target="_blank" rel="noopener noreferrer" class="nav-link external">
  50+Vue经典面试题源码级
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://segmentfault.com/a/1190000018604138" target="_blank" rel="noopener noreferrer" class="nav-link external">
  react面试题
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://juejin.cn/post/6844904055840440334" target="_blank" rel="noopener noreferrer" class="nav-link external">
  从零React项目
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://summerjie007.github.io/vue3_study/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue3+TS
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/airbnb/javascript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  代码规范
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/jiely/00_课程介绍.html" class="sidebar-link">课程指南</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>一.react全家桶上手</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>React基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>React组件基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>React组件通讯</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>React组件通讯进阶</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/jiely/chapter1/04-React组件进阶.html" class="active sidebar-link">React组件进阶</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jiely/chapter1/04-React组件进阶.html#react组件进阶" class="sidebar-link">React组件进阶</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/04-React组件进阶.html#props校验-基本使用" class="sidebar-link">props校验-基本使用</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/04-React组件进阶.html#props校验-常见规则" class="sidebar-link">props校验-常见规则</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/04-React组件进阶.html#props默认值-了解" class="sidebar-link">props默认值(了解)</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/04-React组件进阶.html#props校验和默认值简化-类的静态成员-static-了解" class="sidebar-link">props校验和默认值简化-类的静态成员-static(了解)</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/04-React组件进阶.html#组件生命周期-概述" class="sidebar-link">组件生命周期-概述</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/04-React组件进阶.html#组件生命周期-挂载阶段" class="sidebar-link">组件生命周期-挂载阶段</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/04-React组件进阶.html#组件生命周期-更新阶段" class="sidebar-link">组件生命周期-更新阶段</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/04-React组件进阶.html#组件生命周期-卸载阶段" class="sidebar-link">组件生命周期-卸载阶段</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/04-React组件进阶.html#综合案例-b站评论列表案例" class="sidebar-link">综合案例-B站评论列表案例</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/04-React组件进阶.html#setstate进阶-掌握它的3个特点" class="sidebar-link">setState进阶-掌握它的3个特点</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/04-React组件进阶.html#setstate进阶-第二个参数" class="sidebar-link">setState进阶-第二个参数</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/04-React组件进阶.html#setstate练习" class="sidebar-link">setState练习</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/04-React组件进阶.html#setstate进阶-同步or异步" class="sidebar-link">setState进阶-同步or异步</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/04-React组件进阶.html#json-server-安装及基本使用" class="sidebar-link">json-server-安装及基本使用</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/04-React组件进阶.html#restful接口" class="sidebar-link">RESTful接口</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/04-React组件进阶.html#案例-todos-准备接口" class="sidebar-link">案例-todos-准备接口</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/04-React组件进阶.html#案例-todos-引入素材拆分组件" class="sidebar-link">案例-todos-引入素材拆分组件</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/04-React组件进阶.html#案例-todos-具体功能" class="sidebar-link">案例-todos-具体功能</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>react-hooks基础阶</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>react-hooks进阶</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>redux基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>redux进阶</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>react路由</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>二.react全家桶项目</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>三.前端算法之道</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>四.JS设计设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>五.JS报错总结</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>六.Vue3+Pinia</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>七.node.js</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="react组件进阶"><a href="#react组件进阶" class="header-anchor">#</a> React组件进阶</h2> <ul><li>[ ] children属性</li> <li>[ ] props校验</li> <li>[ ] props默认值</li> <li>[ ] 生命周期与钩子函数</li></ul> <h2 id="props校验-基本使用"><a href="#props校验-基本使用" class="header-anchor">#</a> props校验-基本使用</h2> <h3 id="目标"><a href="#目标" class="header-anchor">#</a> 目标</h3> <p>校验接收的props的数据类型，增加组件的健壮性</p> <h3 id="类型校验的必要性"><a href="#类型校验的必要性" class="header-anchor">#</a> 类型校验的必要性</h3> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAApgAAAERCAYAAADfZtdEAAAcnElEQVR4nO3deVxVdeL/8fcFZNUCjQpBMRXDddwy00wrTdFqptxzX8ZyKddWt0rTaXWrxlLLRtxAXFJx+1a4L2iaNui4TQqlICqYC17v8vvD6f4kQVE/cgFfz8eDx8N7zuec87n8wePlOfecaznz+zmnAAAAAEM83D0BAAAAFC0EJgAAAIwiMAEAAGAUgQkAAACjCEwAAAAYRWACAADAKAITAAAARhGYAAAAMIrABAAAgFEEJgAAAIwiMAEAAGCU161sfO7cOZ06dVKSxdB0AAAAkN+8vb11zz33yNPT08j+bjowd2xP1Nq1CXI6nUYmAgAAAPcpVaqU2rRtr+LFi9/yvm7qEvm5c+eISwAAgCLk5MmT2rp1i5F93VRgnjp1krgEAAAoYnbt/NHIfm7yJh8+cwkAAICc3dJNPn9WpkxZk7sDAADAbZKcfPSqZWFhZYzs21hglilTVu3adzC1OwAAANxGycnJipk/N9syi8XMVWqegwkAAACjCEwAAAAYRWACAADAKAITAAAARhGYAAAAMIrABAAAgFEEJgAAAIwiMAEAAGAUgQkAAACjCEwAAAAYRWACAADAKAITAAAARhGYAAAAMIrABAAAgFEEJgAAAIwiMAEAAGAUgQkAAACj7pjA3L9/v5xOp5F9HTp0UDt2bL9q+caNG7R3714jxwAAACisCkVgZmZmavCggfr9999dy3b++KMuXbqUp+2dTqdaP/+c2rdr64rM2JgYpaWlyWazuX5SkpP11ltvymq1XnN/06ZN05NPPK5ly5Zmi9atW7eq/sMPacuWzTfxLgEAAIoGL3dP4HqcTqf69+urb79dokuXLunTzz6XJGVkZOiZp1tp0ODBat68hSwWS677SEzcpiNHflG37t1d42Ji5uv1119VZGRl17hjx47p0KGDerzJ42r21FM57stqtWre3DmqXr26oqJaavy492S32zVo8BB5eXrJz89f9es/YvA3AAAAULgU+DOY0778Qt9+u0SvDByoSZOnuJY//sQT+urrmfrwgw/07DOttHv37lz3ETN/vqpXr66BAwe5LpV7eXmpceMmil+x0vUz4OWX5ePjk2tcSlJ8/HKdOnVK4//xvjw9PbVu3TrFxy+Xh4dFxYoV+F4HAAC47Qp0YK5e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" alt="image-20210925185145405"></p> <p>对于子组件来说，props是外来的，无法保证组件使用者传入什么格式的数据，有了类型校验，我们的程序就更加健壮了。</p> <h3 id="步骤"><a href="#步骤" class="header-anchor">#</a> 步骤</h3> <ol><li><p>导入 <code>prop-types</code> 包 。这个包在脚手架创建项目时就自带了，无须额外安装</p> <p><code>import PropTypes from 'prop-types'</code> 这里的PropTypes可以改成其他的名字</p></li> <li><p>使用<code>组件名.propTypes = {属性名1: 类型1, ...}</code> 来给组件的props添加校验规则</p> <p>这里的propTypes是固定写法</p></li></ol> <h3 id="示例"><a href="#示例" class="header-anchor">#</a> 示例</h3> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> PropTypes <span class="token keyword">from</span> <span class="token string">'prop-types'</span>
<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Hi, </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>colors<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>
App<span class="token punctuation">.</span>propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// 约定colors属性为array类型</span>
    <span class="token comment">// 如果类型不对，则报出明确错误，便于分析错误原因</span>
    <span class="token literal-property property">colors</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>array
<span class="token punctuation">}</span>
</code></pre></div><p>作用：规定接收的props的类型必须为数组，如果不是数组就会报错，报错的格式如下：</p> <p><img src="/jiely/assets/img/propsjiaoyan03.e782b84b.png" alt=""></p> <h3 id="小结"><a href="#小结" class="header-anchor">#</a> 小结</h3> <ol><li>为啥要对props进行校验？</li> <li>步骤是：
<ol><li>导入_______包</li> <li>设置格式：_________</li></ol></li></ol> <h2 id="props校验-常见规则"><a href="#props校验-常见规则" class="header-anchor">#</a> props校验-常见规则</h2> <h3 id="目标-2"><a href="#目标-2" class="header-anchor">#</a> 目标</h3> <p>了解react组件props校验的常见规则</p> <p><strong>内容：</strong></p> <ol><li>常见类型：array、bool、func、number、object、string</li> <li>React元素类型：element</li> <li>必填项：isRequired</li> <li>特定结构的对象：shape({ })</li></ol> <h3 id="示例-2"><a href="#示例-2" class="header-anchor">#</a> 示例</h3> <div class="language-jsx extra-class"><pre class="language-jsx"><code>Com<span class="token punctuation">.</span>propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">fn</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>func<span class="token punctuation">,</span> <span class="token comment">// fn 是函数类型</span>
  <span class="token literal-property property">isEdit</span><span class="token operator">:</span> PropTypes<span class="token operator">:</span>bool<span class="token punctuation">.</span>isRequired <span class="token comment">// isEdit的类型是bool，且必须要传入</span>
  
  <span class="token comment">// 特定结构的对象</span>
  <span class="token literal-property property">goodInfo</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span><span class="token function">shape</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token comment">// goodInfo的格式一个对象，有 数值price属性 和 字符串name属性</span>
    <span class="token literal-property property">price</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>number<span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>string
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="props默认值-了解"><a href="#props默认值-了解" class="header-anchor">#</a> props默认值(了解)</h2> <h3 id="目标-3"><a href="#目标-3" class="header-anchor">#</a> 目标</h3> <p>掌握给组件的props提供默认值的两种方法</p> <h3 id="默认值"><a href="#默认值" class="header-anchor">#</a> 默认值</h3> <p>定义： 没有赋值的情况下，给属性赋一个值</p> <p>好处：简化调用组件时要传入的属性，更方便用户使用</p> <h3 id="两种方式"><a href="#两种方式" class="header-anchor">#</a> 两种方式</h3> <p>两种方式：</p> <ol><li><code>defaultProps</code></li> <li>解构赋值的默认值</li></ol> <h3 id="方法1-defaultprops"><a href="#方法1-defaultprops" class="header-anchor">#</a> 方法1：defaultProps</h3> <p>通过<code>defaultProps</code>可以给组件的props设置默认值，在未传入props的时候生效</p> <p>定义组件</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            此处展示props的默认值：</span><span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>pageSize <span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 设置默认值</span>
App<span class="token punctuation">.</span>defaultProps <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">pageSize</span><span class="token operator">:</span> <span class="token number">10</span>
<span class="token punctuation">}</span>
<span class="token comment">// 类型限制</span>
App<span class="token punctuation">.</span>propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">pageSize</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>number
<span class="token punctuation">}</span>
</code></pre></div><p>使用组件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 不传入pageSize属性</span>
<span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre></div><h3 id="方法2-解构赋值的默认值"><a href="#方法2-解构赋值的默认值" class="header-anchor">#</a> 方法2：解构赋值的默认值</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
     <span class="token comment">// 解构赋值的默认值</span>
     <span class="token keyword">const</span> <span class="token punctuation">{</span> pageSize <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
            此处展示props的默认值：<span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>pageSize <span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 类型限制</span>
App<span class="token punctuation">.</span>propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">pageSize</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>number
<span class="token punctuation">}</span>
</code></pre></div><h3 id="小结-2"><a href="#小结-2" class="header-anchor">#</a> 小结</h3> <h2 id="props校验和默认值简化-类的静态成员-static-了解"><a href="#props校验和默认值简化-类的静态成员-static-了解" class="header-anchor">#</a> props校验和默认值简化-类的静态成员-static(了解)</h2> <h3 id="目标-4"><a href="#目标-4" class="header-anchor">#</a> 目标</h3> <p>了解静态属性的概念和特点，能用它来简化props校验和默认值</p> <h3 id="什么是静态成员"><a href="#什么是静态成员" class="header-anchor">#</a> 什么是静态成员</h3> <ul><li><p>静态成员：通过类或者构造函数本身才能访问的属性或者方法</p></li> <li><p>实例成员:  通过实例调用的属性或者方法</p> <p>示例</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name <span class="token comment">// 实例成员</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">static</span> n <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">// 静态成员 有static修饰</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <h3 id="静态成员的定义和访问"><a href="#静态成员的定义和访问" class="header-anchor">#</a> 静态成员的定义和访问</h3> <p>定义</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name <span class="token comment">// 实例成员</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 方法1：在class内部 通过static来定义</span>
  <span class="token keyword">static</span> n <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">// 静态成员 有static修饰</span>
<span class="token punctuation">}</span>
<span class="token comment">// 方法2 在class外部 通过类型.属性名来定义</span>
Person<span class="token punctuation">.</span><span class="token function-variable function">m</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
</code></pre></div><p>访问</p> <div class="language- extra-class"><pre class="language-text"><code>Person.n
Person.m()
</code></pre></div><h3 id="简化props校验和默认值"><a href="#简化props校验和默认值" class="header-anchor">#</a> 简化props校验和默认值</h3> <p>把校验规则和默认值放入class内部</p> <h2 id="组件生命周期-概述"><a href="#组件生命周期-概述" class="header-anchor">#</a> 组件生命周期-概述</h2> <h3 id="目标-5"><a href="#目标-5" class="header-anchor">#</a> 目标</h3> <p>能够理解什么是组件的生命周期</p> <h3 id="生命周期"><a href="#生命周期" class="header-anchor">#</a> 生命周期</h3> <p>生命周期：一个事物从创建到最后消亡经历的整个过程</p> <p>组件的生命周期：组件从被创建到挂载到页面中运行，再到组件不用时卸载的过程</p> <p>意义：组件的生命周期有助于理解组件的运行方式、完成更复杂的组件功能、分析组件错误原因等</p> <h3 id="钩子函数"><a href="#钩子函数" class="header-anchor">#</a> 钩子函数</h3> <p>在生命周期的不同阶段，会<strong>自动被调用执行的函数</strong>，为开发人员在不同阶段操作组件提供了时机。</p> <p>注意：只有<strong>类组件</strong> 才有生命周期钩子函数</p> <p><img src="/jiely/assets/img/ren.dd3ae74e.png" alt="ren"></p> <h3 id="react类组件的生命周期钩子函数-整体说明"><a href="#react类组件的生命周期钩子函数-整体说明" class="header-anchor">#</a> react类组件的生命周期钩子函数-整体说明</h3> <p><a href="http://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/" target="_blank" rel="noopener noreferrer">http://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/jiely/assets/img/smzhouqi.09403950.png" alt="image-20211105104421145"></p> <h3 id="小结-3"><a href="#小结-3" class="header-anchor">#</a> 小结</h3> <ol><li>_______组件有生命周期，____组件没有生命周期的概念</li> <li>类组件的生命周期有__个阶段， 5个钩子函数</li></ol> <h2 id="组件生命周期-挂载阶段"><a href="#组件生命周期-挂载阶段" class="header-anchor">#</a> 组件生命周期-挂载阶段</h2> <h3 id="目标-6"><a href="#目标-6" class="header-anchor">#</a> 目标</h3> <p>能够说出组件的挂载阶段的钩子函数以及执行时机</p> <h3 id="内容"><a href="#内容" class="header-anchor">#</a> 内容</h3> <ul><li><p>执行时机：组件创建时（页面加载时）</p></li> <li><p>执行顺序：constructor() -&gt; render() -&gt; componentDidMount()</p></li></ul> <p><img src="images/%E7%BB%84%E4%BB%B6%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F.png" alt=""></p> <table><thead><tr><th>钩子 函数</th> <th>触发时机</th> <th>作用</th></tr></thead> <tbody><tr><td>constructor</td> <td>创建组件时，最先执行</td> <td>1. 初始化state  2. 创建Ref等</td></tr> <tr><td>render</td> <td>每次组件渲染都会触发</td> <td>渲染UI</td></tr> <tr><td>componentDidMount</td> <td>组件挂载（完成DOM渲染）后</td> <td>1. 发送网络请求   2.DOM操作</td></tr></tbody></table> <h3 id="小结-4"><a href="#小结-4" class="header-anchor">#</a> 小结</h3> <ol><li>挂载阶段有____个钩子? 分别是？ 各个钩子函数中可以适合做什么事？</li></ol> <h2 id="组件生命周期-更新阶段"><a href="#组件生命周期-更新阶段" class="header-anchor">#</a> 组件生命周期-更新阶段</h2> <h3 id="目标-7"><a href="#目标-7" class="header-anchor">#</a> 目标</h3> <p>能够说出组件的更新阶段的钩子函数以及执行时机</p> <h3 id="更新阶段的钩子"><a href="#更新阶段的钩子" class="header-anchor">#</a> 更新阶段的钩子</h3> <p>更新阶段会执行两个钩子： render() -&gt; componentDidUpdate()</p> <p><img src="/jiely/assets/img/update.c78eb0a8.png" alt=""></p> <p>三种操作可触发组件更新</p> <ol><li>调用setState。它能改数据&amp;&amp; 更新页面</li> <li>调用forceUpdate()</li> <li>组件接收到新的props</li></ol> <p>说明：以上三者任意一种发生，组件就会进入更新阶段</p> <h3 id="更新阶段能做的事情"><a href="#更新阶段能做的事情" class="header-anchor">#</a> 更新阶段能做的事情</h3> <table><thead><tr><th>钩子函数</th> <th>触发时机</th> <th>作用</th></tr></thead> <tbody><tr><td>render</td> <td>每次组件渲染都会触发</td> <td>渲染UI（与 挂载阶段 是同一个render）</td></tr> <tr><td>componentDidUpdate</td> <td>组件更新（完成DOM渲染）后</td> <td>DOM操作，可以获取到更新后的DOM内容</td></tr></tbody></table> <p>如果有些事情是需要每次更新去做的，就可以写在componentDidUpdate中。例如：数据本地存储</p> <h3 id="小结-5"><a href="#小结-5" class="header-anchor">#</a> 小结</h3> <ol><li>更新阶段有________________________个钩子，分别可以做什么事情？</li></ol> <h2 id="组件生命周期-卸载阶段"><a href="#组件生命周期-卸载阶段" class="header-anchor">#</a> 组件生命周期-卸载阶段</h2> <h3 id="目标-8"><a href="#目标-8" class="header-anchor">#</a> 目标</h3> <p>能够说出组件的销毁阶段的钩子函数以及执行时机</p> <h3 id="内容-2"><a href="#内容-2" class="header-anchor">#</a> 内容</h3> <p>执行时机：组件销毁</p> <table><thead><tr><th>钩子函数</th> <th>触发时机</th> <th>作用</th></tr></thead> <tbody><tr><td>componentWillUnmount</td> <td>组件卸载（从页面中消失）</td> <td>执行清理工作（比如：清理定时器等）</td></tr></tbody></table> <h3 id="示例-清理定时器-移除事件"><a href="#示例-清理定时器-移除事件" class="header-anchor">#</a> 示例：清理定时器&amp;&amp;移除事件</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/* eslint-disable react/prop-types */</span>
<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> createRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>

<span class="token keyword">class</span> <span class="token class-name">Son</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'子组件:'</span><span class="token punctuation">,</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'鼠标移动...'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mousemove'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fn<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>子组件<span class="token operator">:</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>content<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentDidUpdate</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'子组件: componentDidUpdate'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentWillUnmount</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'子组件 卸载: componentWillUnmount'</span><span class="token punctuation">)</span>
    <span class="token comment">// 删除事件</span>
    window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'mousemove'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fn<span class="token punctuation">)</span>
    <span class="token comment">// 删除定时器</span>
    <span class="token function">clearInterval</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>timer<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1. constructor'</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
      <span class="token literal-property property">isShow</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>refTxt <span class="token operator">=</span> <span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">hChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">content</span><span class="token operator">:</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">click</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">forceUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'2. render'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>click<span class="token punctuation">}</span><span class="token operator">&gt;</span>更新<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        组件<span class="token operator">&lt;</span>input value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>content<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>hChange<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>br <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>isShow <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>Son content<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>content<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentDidMount</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'3. componentDidMount'</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>refTxt<span class="token punctuation">.</span>current<span class="token punctuation">)</span>

    <span class="token comment">// axios.get()</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentDidUpdate</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'更新完成： componentDidUpdate'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="综合案例-b站评论列表案例"><a href="#综合案例-b站评论列表案例" class="header-anchor">#</a> 综合案例-B站评论列表案例</h2> <p>本地持久化的功能</p> <p>核心代码</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>list<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> list <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="setstate进阶-掌握它的3个特点"><a href="#setstate进阶-掌握它的3个特点" class="header-anchor">#</a> setState进阶-掌握它的3个特点</h2> <h3 id="目标-9"><a href="#目标-9" class="header-anchor">#</a> 目标</h3> <p>掌握setState的三个特点</p> <h3 id="问题导入"><a href="#问题导入" class="header-anchor">#</a> 问题导入</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>

  state <span class="token operator">=</span> <span class="token punctuation">{</span>
     <span class="token literal-property property">n</span><span class="token operator">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">hClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">n</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>n<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span> <span class="token comment">// 这会打印？</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>hClick<span class="token punctuation">}</span><span class="token operator">&gt;</span>click<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span id<span class="token operator">=</span><span class="token string">&quot;span&quot;</span><span class="token operator">&gt;</span>
          <span class="token literal-property property">n</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>n<span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="setstate的特点"><a href="#setstate的特点" class="header-anchor">#</a> setState的特点</h3> <ol><li><p>可以表现为异步。</p> <p>setState调用之后，并不会立即去修改state的值，也不会立即去更新dom</p></li> <li><p>多次调用会合并。setState({对象})会合并，再统一触发一次render()</p></li> <li><p>使用不当会死循环。在componentDidUpdate， render 中调用setState()会导致死循环</p></li></ol> <h3 id="小结-6"><a href="#小结-6" class="header-anchor">#</a> 小结</h3> <h2 id="setstate进阶-第二个参数"><a href="#setstate进阶-第二个参数" class="header-anchor">#</a> setState进阶-第二个参数</h2> <h3 id="目标-10"><a href="#目标-10" class="header-anchor">#</a> 目标</h3> <p>能够掌握setState的完整语法格式</p> <h3 id="setstate的第二个参数"><a href="#setstate的第二个参数" class="header-anchor">#</a> setState的第二个参数</h3> <h4 id="格式1"><a href="#格式1" class="header-anchor">#</a> 格式1</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">[</span><span class="token punctuation">,</span>回调函数<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>回调函数是可选的，它的作用是：当本轮setState生效（state更新，页面ui更新）之后，会调用回调函数</p> <h4 id="格式2"><a href="#格式2" class="header-anchor">#</a> 格式2</h4> <p><img src="/jiely/assets/img/image-20211109114556864.9d53c44f.png" alt="image-20211109114556864"></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">上一状态</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> 新状态
<span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token punctuation">,</span>回调函数<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>回调函数是可选的，它的作用是：当本轮setState生效（state更新，页面ui更新）之后，会调用回调函数</p> <h3 id="示例1"><a href="#示例1" class="header-anchor">#</a> 示例1</h3> <div class="language-js extra-class"><pre class="language-js"><code>  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">n</span><span class="token operator">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">hClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span> <span class="token parameter">preState</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">n</span><span class="token operator">:</span> preState<span class="token punctuation">.</span>n <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span> <span class="token parameter">preState</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">n</span><span class="token operator">:</span> preState<span class="token punctuation">.</span>n <span class="token operator">+</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span> <span class="token parameter">preState</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">n</span><span class="token operator">:</span> preState<span class="token punctuation">.</span>n <span class="token operator">+</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 页面上的n会是多少？</span>
</code></pre></div><p>state可以获取到叠加的状态，适用于需要调用多次setState</p> <h3 id="示例2"><a href="#示例2" class="header-anchor">#</a> 示例2</h3> <div class="language-js extra-class"><pre class="language-js"><code>  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">n</span><span class="token operator">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">hClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span> <span class="token parameter">preState</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">n</span><span class="token operator">:</span> preState<span class="token punctuation">.</span>n <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>n<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span> <span class="token parameter">preState</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">n</span><span class="token operator">:</span> preState<span class="token punctuation">.</span>n <span class="token operator">+</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>n<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span> <span class="token parameter">preState</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">n</span><span class="token operator">:</span> preState<span class="token punctuation">.</span>n <span class="token operator">+</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>n<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 1. 页面上的n会是多少？</span>
  <span class="token comment">// 2. 三个console.log会输出什么？</span>
</code></pre></div><p>state可以获取到最新的状态，适用于获取state更新之后的状态。</p> <h2 id="setstate练习"><a href="#setstate练习" class="header-anchor">#</a> setState练习</h2> <h3 id="任务说明"><a href="#任务说明" class="header-anchor">#</a> 任务说明</h3> <p>初始初始隐藏textarea。</p> <p>点击回复按钮之后：</p> <ol><li>显示textArea</li> <li>让它获取焦点</li></ol> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAScAAABVCAYAAAALxyI/AAAD10lEQVR4nO3dP0vjcBzH8Y9Hn0AWh1sCt3S4Tc71tuumSO0sCEofQJWidCwn4c4HIC0IziqCTnFzFQoODl0OXG7okofQG6pn1dim0fT3TX2/oKCxf74Ivkl+Texcv9/vCwCM+eR6AACIQ5wAmEScAJhEnACYRJwAmEScAJhEnACYRJwAmEScAJhEnACYRJwAmEScAJhEnACYRJwAmFRwPcB7qdfrrkcAcikIAtcjxJqJONXrdbO/YMA6q38/HNYBMIk4ATCJOAEwiTgBMIk4ATCJOAEwiTgBMIk4ATCJOAEwiTgBMIk4ATCJOAEwiTgBMIk4ATCJOAEwiTgBMIk4ATCJOAEwiTgBMIk4ATCpkOdPLfF9X+Vy2fUYADJQ2NnZcT1Dap1OR6enp67HAJCBXB/WLSws6O7uzvUYADKQ6zgBmF3ECYBJxAmAScQJgEnECYBJU4tT72RNnrev62m9IIBcK7z+o56O14vaPEvxrLuhou3Fx+//Hmtr41zSuUpeM/HTLLW7OlqdTzEAgFGq1aoODg5cjzHSiDgNTBqI61+eSk+3aP/rptTuKiI0gHN5CJOUIE5vc619r6SmJG0U5W0kfNhKS93DikgZ8L7yEiYp0zj1dLxe0k27q662VLxYThSc3smaihfZTQV8VHkKkzRRnIb2gl5oKIxqWnyybV6Vw0gVSb0TSWebKp5tJnupleXkYwEYK29hklK8W9e4jBRFQ7fLRrIHrrTUjZ49NubWbS9NOhKAEeLCVK1WHU2TXMZrTkPYcwKm7rUw5WEvanpxSrjIzZoT8D7yHCZpSidhzq8eKTr8rqt1b+yJmIP78k4d8BZ5D5OUYs+p+cOLWRQft+40vJjeHH8iJqcSAKnNQpikKSyIDy5bKam5GyqKQjW0pNZt3GJ4eJ+4hkLCBKQWF6G8hUmaaM9pUbUoern5W01xmx8vf2kojI7+n2ZQi37reN2TdyZpN1Sokko/pcHpCJFinwrAh5Phgvj9eU6Hw9uGD++W1Ppypas/DUlNDQ73btS6PVLl82SvFASB8vxBDYBLQRC4HiHW2DidT3LZyYPdhy+eXzwcv3dU264N3f9+r0p6eQHxCFZ/wQDSyfjC37i9p1EmvT+AWTUiTo+Xn0xicZt1IwBvx3/CBGAScQJgEnECYFKu49TpdOT7vusxAGSgsLe353qG1HzfV7lcdj0GgAzM9fv9vushAOC5XB/WAZhdxAmAScQJgEnECYBJxAmAScQJgEnECYBJxAmAScQJgEnECYBJxAmAScQJgEnECYBJxAmAScQJgEnECYBJxAmASf8AMzs7+pF4fncAAAAASUVORK5CYII=" alt="image-20211107210459914"></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">isReplay</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">hClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 你的代码</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>要求：初始隐藏textarea。点击回复按钮，显示textArea，并让它获取焦点<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>hClick<span class="token punctuation">}</span><span class="token operator">&gt;</span>回复<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>textarea <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><p>完成：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>
<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> createRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>txtRef <span class="token operator">=</span> <span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">isShow</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">hClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">isShow</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 获取焦点</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>txtRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>hClick<span class="token punctuation">}</span><span class="token operator">&gt;</span>回复<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>isShow <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>textarea ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>txtRef<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="setstate进阶-同步or异步"><a href="#setstate进阶-同步or异步" class="header-anchor">#</a> setState进阶-同步or异步</h2> <h3 id="目标-11"><a href="#目标-11" class="header-anchor">#</a> 目标</h3> <p>能够说出setState到底是同步的还是异步</p> <h3 id="内容-3"><a href="#内容-3" class="header-anchor">#</a> 内容</h3> <p>setState本身并不是一个异步(setTime, setInterval, ajax,Promise.then.....)方法，其之所以会表现出一种异步的形式，是因为react框架本身的性能优化机制</p> <blockquote><p>在React中，如果是由React引发的事件处理（比如通过onClick引发的事件处理），调用 setState 不会同步更新 this.state，除此之外的setState调用会同步执行this.state。</p></blockquote> <p>所谓“除此之外”，指的是绕过React通过 <code>addEventListener</code> 直接添加的事件处理函数，还有通过<code>setTimeout</code> || <code>setInterval</code> 产生的异步调用。</p> <p>简单一点说：</p> <ol><li>经过React 处理（事件回调，钩子函数）中的setState是<code>异步更新</code></li> <li>没有经过React处理（通过 <code>addEventListener</code> || <code>setTimeout</code>/<code>setInterval</code>）中的setState是<code>同步更新</code>。</li></ol> <p><img src="/jiely/assets/img/image-20211108213825185.32aa8c7e.png" alt="image-20211108213825185"></p> <h3 id="示例代码"><a href="#示例代码" class="header-anchor">#</a> 示例代码</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> reactDom <span class="token keyword">from</span> <span class="token string">'react-dom'</span>

<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">n</span><span class="token operator">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// setTimeout(() =&gt; {</span>
  <span class="token comment">//   this.setState({ n: 2 })</span>
  <span class="token comment">//   console.log(this.state.n)</span>
  <span class="token comment">//   console.log(document.getElementById('btn').innerHTML)</span>
  <span class="token comment">// }, 2000)</span>

  <span class="token function">componentDidMount</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// this.setState({ n: 2 })</span>
    <span class="token comment">// console.log(this.state.n)</span>
    <span class="token comment">// console.log(document.getElementById('btn').innerHTML)</span>

    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">n</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>n<span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">click</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">n</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>n<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span><span class="token comment">/* &lt;button id=&quot;btn&quot; onClick={this.click}&gt; */</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">&quot;btn&quot;</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>click<span class="token punctuation">}</span><span class="token operator">&gt;</span>
          <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>n<span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

reactDom<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h3> <p>setState是同步的方法，但是react为了性能优化，所以setState在react的事件中表现得像异步。</p> <p>参考链接：</p> <ul><li>https://zhuanlan.zhihu.com/p/158725289</li> <li>https://segmentfault.com/a/1190000015463599</li></ul> <h2 id="json-server-安装及基本使用"><a href="#json-server-安装及基本使用" class="header-anchor">#</a> json-server-安装及基本使用</h2> <p>参考：<a href="https://www.cnblogs.com/fly_dragon/p/9186722.html" target="_blank" rel="noopener noreferrer">教程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>官网： <a href="https://www.npmjs.com/package/json-server" target="_blank" rel="noopener noreferrer">npm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="作用"><a href="#作用" class="header-anchor">#</a> 作用</h3> <p>能json-server快速地根据已有json文件，生成接口</p> <blockquote><p>json  ----json-server-----&gt; 接口</p></blockquote> <h3 id="使用步骤"><a href="#使用步骤" class="header-anchor">#</a> 使用步骤</h3> <h4 id="全局安装json-server"><a href="#全局安装json-server" class="header-anchor">#</a> 全局安装json-server</h4> <blockquote><p>以前安装过的全局包：<code>nodemon</code>,<code>nrm</code></p></blockquote> <p>它是依赖于nodejs的第三方包，它是一个独立的工具，并不限于某个项目，可以全局安装。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> i json-server -g
</code></pre></div><p><img src="/jiely/assets/img/image-20210116101245697.8b9bc713.png" alt="image-20210116101245697"></p> <blockquote><p>如果是mac本，可能需要加sudo，即：sudo npm i json-server -g</p></blockquote> <h4 id="准备空文件夹"><a href="#准备空文件夹" class="header-anchor">#</a> 准备空文件夹</h4> <p>在任意目录下，准备一个空文件夹，取名mock-server(可改成其它名字)</p> <p><img src="data:image/png;base64,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" alt="1586748855799"></p> <h4 id="创建json文件"><a href="#创建json文件" class="header-anchor">#</a> 创建json文件</h4> <p>在文件夹中新建一个名为db.json文件(可改其它名称，注意<strong>名字是是英文</strong>）</p> <p><img src="/jiely/assets/img/1586748923154-1589332581419.33e356f2.png" alt="1586748923154"></p> <h4 id="初始化结构"><a href="#初始化结构" class="header-anchor">#</a> 初始化结构</h4> <p>在db.json文件中，按json格式的要求，去定义一个对象：</p> <ul><li>键值对格式</li> <li>用<strong>双引号</strong>括起来</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;assets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
	    <span class="token punctuation">{</span> <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;外套&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">99</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
	    <span class="token punctuation">{</span> <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;裤子&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">34</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
	    <span class="token punctuation">{</span> <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;鞋&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">25.4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
	    <span class="token punctuation">{</span> <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;头发&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">19900</span> <span class="token punctuation">}</span>
	<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="启动接口服务"><a href="#启动接口服务" class="header-anchor">#</a> 启动接口服务</h4> <p>根据上面创建的db.json自动地生成接口。</p> <p>进入到上一步创建的文件夹下，</p> <p>在<strong>此文件夹</strong>下，打开命令行窗口，输入命令<code>json-server db.json -p 8888</code> (json-server后有空格)</p> <p><img src="/jiely/assets/img/1586749263939-1589332581419.10211db2.png" alt="1586749263939"></p> <p>如果没有错误，则运行结果如下：
<img src="/jiely/assets/img/image-20200510094752899-1589332581420.9dfe21d5.png" alt="image-20200510094752899"></p> <h4 id="测试"><a href="#测试" class="header-anchor">#</a> 测试</h4> <p>在浏览器中访问上面地址</p> <p>注意：</p> <ul><li>产生的接口地址中的<code>/assets</code>是与db.json中的属性名是对应的。</li> <li>db.json的内容必须是json格式。</li> <li>属性名 ---&gt; 接口的地址</li> <li>属性值 ---&gt; 接口返回数据 （数组|对象）</li></ul> <h3 id="原理图"><a href="#原理图" class="header-anchor">#</a> 原理图</h3> <h3 id="注意"><a href="#注意" class="header-anchor">#</a> 注意</h3> <ul><li>小黑窗不要关！</li> <li>小黑窗上不要用鼠标选中任何内容！</li></ul> <h2 id="restful接口"><a href="#restful接口" class="header-anchor">#</a> RESTful接口</h2> <h3 id="目标-12"><a href="#目标-12" class="header-anchor">#</a> 目标</h3> <p>了解restFul风格的定义</p> <h3 id="问题导入-2"><a href="#问题导入-2" class="header-anchor">#</a> 问题导入</h3> <p>在写接口时，每个程序员都有自己的写法:取不同的名字，例如：实现添加资产</p> <blockquote><p>A同学： localhost:3000/add/asset     | del/asset</p> <p>B同学： localhost:3000/insert/asset  | delete/asset</p> <p>C同学： localhost:3000/tjzj                 | sczj</p></blockquote> <h3 id="restful接口-2"><a href="#restful接口-2" class="header-anchor">#</a> RESTful接口</h3> <p>针对上述问题，提出一套约定。RESTful接口的规范是通过：</p> <blockquote><ul><li>请求方式来决定操作类别（添加，删除，修改，查询）</li> <li>用名词来表示要操作的目标</li></ul></blockquote> <p>json-server提供的就是符合restful规则的接口。</p> <h3 id="测试-2"><a href="#测试-2" class="header-anchor">#</a> 测试</h3> <p>以上面启动的服务为例：一旦服务启动成功，就会自动生成如下接口地址。</p> <table><thead><tr><th>接口地址</th> <th>请求方式</th> <th>操作类型</th></tr></thead> <tbody><tr><td>localhost:3000/assets</td> <td>GET</td> <td>获取全部数据</td></tr> <tr><td>localhost:3000/assets/1</td> <td>GET</td> <td>获取单个数据</td></tr> <tr><td>localhost:3000/assets</td> <td>POST</td> <td>添加操作 。参数： {name,price}</td></tr> <tr><td>localhost:3000/assets/1</td> <td>DELETE</td> <td>删除操作</td></tr> <tr><td>localhost:3000/assets/1</td> <td>PUT</td> <td>完整修改。参数：{name,price}</td></tr> <tr><td>localhost:3000/assets/1</td> <td>PATCH</td> <td>局部修改。参数：{name}</td></tr></tbody></table> <p>以上接口就是符合restful要求的接口规则。</p> <h2 id="案例-todos-准备接口"><a href="#案例-todos-准备接口" class="header-anchor">#</a> 案例-todos-准备接口</h2> <h3 id="目标-13"><a href="#目标-13" class="header-anchor">#</a> 目标</h3> <p>用json-server实现接口</p> <h3 id="步骤-2"><a href="#步骤-2" class="header-anchor">#</a> 步骤</h3> <ul><li>准备文件data.json</li></ul> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token punctuation">{</span>
  <span class="token string-property property">&quot;todos&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;读书&quot;</span><span class="token punctuation">,</span>
      <span class="token string-property property">&quot;done&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;写字&quot;</span><span class="token punctuation">,</span>
      <span class="token string-property property">&quot;done&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">4</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre></div><ul><li>使用json-server启动接口</li></ul> <div class="language-jsx extra-class"><pre class="language-jsx"><code>json<span class="token operator">-</span>server data<span class="token punctuation">.</span>json <span class="token operator">--</span>port <span class="token number">8888</span>
</code></pre></div><ul><li>接口地址</li></ul> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">8888</span><span class="token operator">/</span>todos

增加： post
删除： <span class="token keyword">delete</span>
修改： patch  <span class="token operator">/</span> put
获取： <span class="token keyword">get</span>
</code></pre></div><h2 id="案例-todos-引入素材拆分组件"><a href="#案例-todos-引入素材拆分组件" class="header-anchor">#</a> 案例-todos-引入素材拆分组件</h2> <h3 id="目标-14"><a href="#目标-14" class="header-anchor">#</a> 目标</h3> <p>引入基本素材，并拆分组件</p> <h3 id="分析"><a href="#分析" class="header-anchor">#</a> 分析</h3> <img src="/jiely/assets/img/image-20210926090903702.bdfb51d0.png" alt="image-20210926090903702" style="zoom:50%;"> <h3 id="目录结构"><a href="#目录结构" class="header-anchor">#</a> 目录结构</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">|</span>-styles
<span class="token operator">|</span>-------base.css
<span class="token operator">|</span>-------index.css
<span class="token operator">|</span>-components
<span class="token operator">|</span>-------Footer.js
<span class="token operator">|</span>-------Header.js
<span class="token operator">|</span>-------Main.js
<span class="token operator">|</span>-index.js
</code></pre></div><h2 id="案例-todos-具体功能"><a href="#案例-todos-具体功能" class="header-anchor">#</a> 案例-todos-具体功能</h2> <h3 id="index-js"><a href="#index-js" class="header-anchor">#</a> index.js</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> Footer <span class="token keyword">from</span> <span class="token string">'./component/Footer'</span>
<span class="token keyword">import</span> Main <span class="token keyword">from</span> <span class="token string">'./component/Main'</span>
<span class="token keyword">import</span> Header <span class="token keyword">from</span> <span class="token string">'./component/Header'</span>
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">list</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentDidMount</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">getTodos</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8888/todos'</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">list</span><span class="token operator">:</span> res<span class="token punctuation">.</span>data
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'http://localhost:8888/todos'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        content<span class="token punctuation">,</span>
        <span class="token literal-property property">isDone</span><span class="token operator">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">del</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'http://localhost:8888/todos/'</span> <span class="token operator">+</span> id<span class="token punctuation">,</span>
      <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">'delete'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">update</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> isDone</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'http://localhost:8888/todos/'</span> <span class="token operator">+</span> id<span class="token punctuation">,</span>
      <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">'patch'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        isDone
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> list <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>section className<span class="token operator">=</span><span class="token string">&quot;todoapp&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Header add<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>add<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Main update<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>update<span class="token punctuation">}</span> list<span class="token operator">=</span><span class="token punctuation">{</span>list<span class="token punctuation">}</span> del<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>del<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Footer <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>section<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="main-js"><a href="#main-js" class="header-anchor">#</a> main.js</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> PropTypes <span class="token keyword">from</span> <span class="token string">'prop-types'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> list <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>section className<span class="token operator">=</span><span class="token string">&quot;main&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>input id<span class="token operator">=</span><span class="token string">&quot;toggle-all&quot;</span> className<span class="token operator">=</span><span class="token string">&quot;toggle-all&quot;</span> type<span class="token operator">=</span><span class="token string">&quot;checkbox&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>label htmlFor<span class="token operator">=</span><span class="token string">&quot;toggle-all&quot;</span><span class="token operator">&gt;</span>Mark all <span class="token keyword">as</span> complete<span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>ul className<span class="token operator">=</span><span class="token string">&quot;todo-list&quot;</span><span class="token operator">&gt;</span>
          <span class="token punctuation">{</span>list<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">it</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>it<span class="token punctuation">.</span>id<span class="token punctuation">}</span> className<span class="token operator">=</span><span class="token punctuation">{</span>it<span class="token punctuation">.</span>isDone <span class="token operator">?</span> <span class="token string">'completed'</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;view&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>input
                  className<span class="token operator">=</span><span class="token string">&quot;toggle&quot;</span>
                  onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token operator">!</span>it<span class="token punctuation">.</span>isDone<span class="token punctuation">)</span>
                  <span class="token punctuation">}</span><span class="token punctuation">}</span>
                  type<span class="token operator">=</span><span class="token string">&quot;checkbox&quot;</span>
                  checked<span class="token operator">=</span><span class="token punctuation">{</span>it<span class="token punctuation">.</span>isDone<span class="token punctuation">}</span>
                <span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>label<span class="token operator">&gt;</span><span class="token punctuation">{</span>it<span class="token punctuation">.</span>content<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>button
                  onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">del</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">}</span>
                  className<span class="token operator">=</span><span class="token string">&quot;destroy&quot;</span>
                <span class="token operator">/</span><span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span>input className<span class="token operator">=</span><span class="token string">&quot;edit&quot;</span> value<span class="token operator">=</span><span class="token string">&quot;Create a TodoMVC template&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
          <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>

          <span class="token punctuation">{</span><span class="token comment">/* &lt;li&gt;
            &lt;div className=&quot;view&quot;&gt;
              &lt;input className=&quot;toggle&quot; type=&quot;checkbox&quot; /&gt;
              &lt;label&gt;Buy a unicorn&lt;/label&gt;
              &lt;button className=&quot;destroy&quot; /&gt;
            &lt;/div&gt;
            &lt;input className=&quot;edit&quot; value=&quot;Rule the web&quot; /&gt;
          &lt;/li&gt; */</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>section<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
Main<span class="token punctuation">.</span>propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">list</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>array<span class="token punctuation">.</span>isRequired<span class="token punctuation">,</span>
  <span class="token literal-property property">del</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>func<span class="token punctuation">.</span>isRequired<span class="token punctuation">,</span>
  <span class="token literal-property property">update</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>func<span class="token punctuation">.</span>isRequired
<span class="token punctuation">}</span>

</code></pre></div><h3 id="header-js"><a href="#header-js" class="header-anchor">#</a> Header.js</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> PropTypes <span class="token keyword">from</span> <span class="token string">'prop-types'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Header</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">'1'</span> <span class="token punctuation">}</span>
  <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>header className<span class="token operator">=</span><span class="token string">&quot;header&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>todos<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>input
          onKeyUp<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>add<span class="token punctuation">}</span>
          value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>content<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> target <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">content</span><span class="token operator">:</span> target<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">}</span>
          className<span class="token operator">=</span><span class="token string">&quot;new-todo&quot;</span>
          placeholder<span class="token operator">=</span><span class="token string">&quot;What needs to be done?&quot;</span>
          autoFocus
        <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>header<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token string">'Enter'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>content<span class="token punctuation">)</span>

      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">''</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

Header<span class="token punctuation">.</span>propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">add</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>func<span class="token punctuation">.</span>isRequired
<span class="token punctuation">}</span>

</code></pre></div><h3 id="footer-js"><a href="#footer-js" class="header-anchor">#</a> Footer.js</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Footer</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>footer className<span class="token operator">=</span><span class="token string">&quot;footer&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span className<span class="token operator">=</span><span class="token string">&quot;todo-count&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>strong<span class="token operator">&gt;</span><span class="token number">0</span><span class="token operator">&lt;</span><span class="token operator">/</span>strong<span class="token operator">&gt;</span> item left
        <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>ul className<span class="token operator">=</span><span class="token string">&quot;filters&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>a className<span class="token operator">=</span><span class="token string">&quot;selected&quot;</span> href<span class="token operator">=</span><span class="token string">&quot;#/&quot;</span><span class="token operator">&gt;</span>
              All
            <span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;#/active&quot;</span><span class="token operator">&gt;</span>Active<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;#/completed&quot;</span><span class="token operator">&gt;</span>Completed<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button className<span class="token operator">=</span><span class="token string">&quot;clear-completed&quot;</span><span class="token operator">&gt;</span>Clear completed<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>footer<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="列表渲染功能"><a href="#列表渲染功能" class="header-anchor">#</a> 列表渲染功能</h3> <p><strong>核心步骤</strong></p> <ol><li>App组件中通过axios发送请求获取到列表</li> <li>通过父传子把list传递给TodoMain组件</li> <li>TodoMain组件渲染任务列表</li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/jiely/chapter1/03-React组件通讯.html" class="prev">
        组件通讯
      </a></span> <span class="next"><a href="/jiely/chapter1/05-react-hooks基础.html">
        React Hooks
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/jiely/assets/js/app.77e16281.js" defer></script><script src="/jiely/assets/js/3.23c74d3c.js" defer></script><script src="/jiely/assets/js/5.8a58ce3d.js" defer></script>
  </body>
</html>
