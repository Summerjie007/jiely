<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>React Hooks进阶 | react 快速上手</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="shortcut icon" type="image/x-icon" href="./images/favicon.ico">
    <meta name="description" content="杰哥哥前端研究院">
    
    <link rel="preload" href="/jiely/assets/css/0.styles.5afc0e25.css" as="style"><link rel="preload" href="/jiely/assets/js/app.87156db4.js" as="script"><link rel="preload" href="/jiely/assets/js/3.05e47443.js" as="script"><link rel="preload" href="/jiely/assets/js/29.28bb402e.js" as="script"><link rel="prefetch" href="/jiely/assets/js/10.1bb09252.js"><link rel="prefetch" href="/jiely/assets/js/11.7487ab28.js"><link rel="prefetch" href="/jiely/assets/js/12.a9e0b5c6.js"><link rel="prefetch" href="/jiely/assets/js/13.46042c4c.js"><link rel="prefetch" href="/jiely/assets/js/14.7e9485d0.js"><link rel="prefetch" href="/jiely/assets/js/15.82bd5665.js"><link rel="prefetch" href="/jiely/assets/js/16.da48c8d1.js"><link rel="prefetch" href="/jiely/assets/js/17.4c4fbca4.js"><link rel="prefetch" href="/jiely/assets/js/18.8f64b26e.js"><link rel="prefetch" href="/jiely/assets/js/19.6e619bb0.js"><link rel="prefetch" href="/jiely/assets/js/2.af879dde.js"><link rel="prefetch" href="/jiely/assets/js/20.a8659479.js"><link rel="prefetch" href="/jiely/assets/js/21.c50358c3.js"><link rel="prefetch" href="/jiely/assets/js/22.2b3cb2cc.js"><link rel="prefetch" href="/jiely/assets/js/23.ef2a71c6.js"><link rel="prefetch" href="/jiely/assets/js/24.713e58c4.js"><link rel="prefetch" href="/jiely/assets/js/25.9e2de17e.js"><link rel="prefetch" href="/jiely/assets/js/26.ebe2c2c7.js"><link rel="prefetch" href="/jiely/assets/js/27.b410c517.js"><link rel="prefetch" href="/jiely/assets/js/28.416e0f83.js"><link rel="prefetch" href="/jiely/assets/js/30.117590fb.js"><link rel="prefetch" href="/jiely/assets/js/31.012589f4.js"><link rel="prefetch" href="/jiely/assets/js/32.391074f7.js"><link rel="prefetch" href="/jiely/assets/js/33.3b5bff31.js"><link rel="prefetch" href="/jiely/assets/js/34.5f03808f.js"><link rel="prefetch" href="/jiely/assets/js/35.c836f09c.js"><link rel="prefetch" href="/jiely/assets/js/36.cdfd4095.js"><link rel="prefetch" href="/jiely/assets/js/37.3888e0de.js"><link rel="prefetch" href="/jiely/assets/js/38.9d42564b.js"><link rel="prefetch" href="/jiely/assets/js/39.af6cc2f1.js"><link rel="prefetch" href="/jiely/assets/js/4.cb17c8a3.js"><link rel="prefetch" href="/jiely/assets/js/40.28ea6c30.js"><link rel="prefetch" href="/jiely/assets/js/41.07ff3483.js"><link rel="prefetch" href="/jiely/assets/js/42.461144bb.js"><link rel="prefetch" href="/jiely/assets/js/43.7381291e.js"><link rel="prefetch" href="/jiely/assets/js/44.e99c69d5.js"><link rel="prefetch" href="/jiely/assets/js/45.82ace09a.js"><link rel="prefetch" href="/jiely/assets/js/46.6f99a05f.js"><link rel="prefetch" href="/jiely/assets/js/47.50c29aca.js"><link rel="prefetch" href="/jiely/assets/js/48.8de86252.js"><link rel="prefetch" href="/jiely/assets/js/49.7b800d70.js"><link rel="prefetch" href="/jiely/assets/js/5.8ae26c23.js"><link rel="prefetch" href="/jiely/assets/js/6.9b2d155f.js"><link rel="prefetch" href="/jiely/assets/js/7.276458e1.js"><link rel="prefetch" href="/jiely/assets/js/8.b230375e.js"><link rel="prefetch" href="/jiely/assets/js/9.fae1b1d4.js">
    <link rel="stylesheet" href="/jiely/assets/css/0.styles.5afc0e25.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/jiely/" class="home-link router-link-active"><img src="/jiely/images/logo.jpg" alt="react 快速上手" class="logo"> <span class="site-name can-hide">react 快速上手</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://juejin.cn/post/7097067108663558151" target="_blank" rel="noopener noreferrer" class="nav-link external">
  50+Vue经典面试题源码级
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://segmentfault.com/a/1190000018604138" target="_blank" rel="noopener noreferrer" class="nav-link external">
  react面试题
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://juejin.cn/post/6844904055840440334" target="_blank" rel="noopener noreferrer" class="nav-link external">
  从零React项目
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://summerjie007.github.io/vue3_study/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue3+TS
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/airbnb/javascript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  代码规范
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://juejin.cn/post/7097067108663558151" target="_blank" rel="noopener noreferrer" class="nav-link external">
  50+Vue经典面试题源码级
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://segmentfault.com/a/1190000018604138" target="_blank" rel="noopener noreferrer" class="nav-link external">
  react面试题
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://juejin.cn/post/6844904055840440334" target="_blank" rel="noopener noreferrer" class="nav-link external">
  从零React项目
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://summerjie007.github.io/vue3_study/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue3+TS
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/airbnb/javascript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  代码规范
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/jiely/00_课程介绍.html" class="sidebar-link">课程指南</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>一.react全家桶上手</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>React基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>React组件基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>React组件通讯</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>React组件通讯进阶</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>react-hooks基础阶</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>react-hooks进阶</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/jiely/chapter1/06-react-hooks进阶.html" class="active sidebar-link">React Hooks进阶</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jiely/chapter1/06-react-hooks进阶.html#react-hooks进阶" class="sidebar-link">React Hooks进阶</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/06-react-hooks进阶.html#useeffect发送请求" class="sidebar-link">useEffect发送请求</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/06-react-hooks进阶.html#useeffect-副作用函数的返回值-清理副作用" class="sidebar-link">useEffect-副作用函数的返回值-清理副作用</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/06-react-hooks进阶.html#useeffect-清理副作用-案例" class="sidebar-link">useEffect-清理副作用-案例</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/06-react-hooks进阶.html#案例-鼠标跟随" class="sidebar-link">案例-鼠标跟随</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/06-react-hooks进阶.html#自定义hooks-应用场景" class="sidebar-link">自定义hooks-应用场景</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/06-react-hooks进阶.html#自定义hooks-实操" class="sidebar-link">自定义hooks-实操</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/06-react-hooks进阶.html#useref-操作dom" class="sidebar-link">useRef-操作DOM</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/06-react-hooks进阶.html#useref-在多次渲染之间共享数据-停止定时器" class="sidebar-link">useRef-在多次渲染之间共享数据-停止定时器</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/06-react-hooks进阶.html#自定义hooks-封装倒计时-需求-验证码" class="sidebar-link">自定义hooks-封装倒计时-需求-验证码</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/06-react-hooks进阶.html#自定义hooks-封装倒计时-需求-404页面3秒跳转" class="sidebar-link">自定义hooks-封装倒计时-需求-404页面3秒跳转</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/06-react-hooks进阶.html#自定义hooks-封装倒计时-提炼hooks" class="sidebar-link">自定义hooks-封装倒计时-提炼hooks</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/06-react-hooks进阶.html#usecontext-全局状态" class="sidebar-link">useContext-全局状态</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/06-react-hooks进阶.html#购物车案例-发送请求-获取列表数据" class="sidebar-link">购物车案例-发送请求-获取列表数据</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/06-react-hooks进阶.html#mycount组件的封装-基本结构" class="sidebar-link">MyCount组件的封装-基本结构</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/06-react-hooks进阶.html#数量控制-usecontext" class="sidebar-link">数量控制-useContext</a></li><li class="sidebar-sub-header"><a href="/jiely/chapter1/06-react-hooks进阶.html#拓展-使用-eslint-插件帮助检查-hooks-的使用" class="sidebar-link">拓展-使用 ESLint 插件帮助检查 Hooks 的使用</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>redux基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>redux进阶</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>react路由</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>二.react全家桶项目</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>三.前端算法之道</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>四.JS设计设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>五.JS报错总结</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>六.Vue3+Pinia</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>七.node.js</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="react-hooks进阶"><a href="#react-hooks进阶" class="header-anchor">#</a> React Hooks进阶</h2> <ul><li>[ ] useState 回调函数形式的参数</li> <li>[ ] useEffect 清理副作用</li> <li>[ ] useRef操作DOM</li> <li>[ ] useContext组件通讯</li></ul> <h2 id="useeffect发送请求"><a href="#useeffect发送请求" class="header-anchor">#</a> useEffect发送请求</h2> <h3 id="目的"><a href="#目的" class="header-anchor">#</a> 目的</h3> <p>能够在函数组件中通过useEffect发送ajax请求</p> <h3 id="格式"><a href="#格式" class="header-anchor">#</a> 格式</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 正确使用</span>
<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 定义一个函数</span>
  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fetchMyAPI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token string">'http://something/'</span> <span class="token operator">+</span> productId
    <span class="token keyword">let</span> config <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">myFetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 调用它</span>
  <span class="token function">fetchMyAPI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>productId<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>注意：<strong>effect 只能是一个同步函数，不能使用 async</strong></p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// 错误演示：</span>

<span class="token comment">// 不要给 effect 添加 async</span>
<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> awiat <span class="token function">xxx</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="useeffect-副作用函数的返回值-清理副作用"><a href="#useeffect-副作用函数的返回值-清理副作用" class="header-anchor">#</a> useEffect-副作用函数的返回值-清理副作用</h2> <h3 id="目标"><a href="#目标" class="header-anchor">#</a> 目标</h3> <p>掌握副作用函数的返回值的使用，能在在组件卸载的时候，清除注册的事件</p> <h3 id="副作用函数的返回值"><a href="#副作用函数的返回值" class="header-anchor">#</a> 副作用函数的返回值</h3> <h4 id="格式-2"><a href="#格式-2" class="header-anchor">#</a> 格式</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 副作用函数的内容</span>

  <span class="token keyword">return</span> 副作用函数的返回值
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>副作用函数的返回值是可选的，可省略。也可以返回一个<strong>清理函数</strong>，用来清理副作用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 副作用函数的内容</span>

  <span class="token keyword">return</span> <span class="token parameter">（）</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span> <span class="token comment">/* 做清理工作*/</span> <span class="token punctuation">}</span> <span class="token comment">// 清理函数</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>清理函数的执行时机：</p> <ul><li><strong>清理函数</strong>会<strong>在组件卸载时</strong>以及<strong>下一次副作用函数调用之前</strong>执行</li></ul> <h3 id="示例-执行时机"><a href="#示例-执行时机" class="header-anchor">#</a> 示例：执行时机</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useEffect<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDom <span class="token keyword">from</span> <span class="token string">'react-dom'</span>

<span class="token keyword">function</span> <span class="token function">Com1</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'子组件的副作用函数'</span><span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'子组件的副作用函数的清理函数'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>子组件<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isShow<span class="token punctuation">,</span> setIsShow<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCcount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'父组件的副作用函数的内容'</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'父组件的副作用函数的 清理函数 的内容'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">)</span>
  
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>isShow <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>Com1 <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setIsShow</span><span class="token punctuation">(</span><span class="token operator">!</span>isShow<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>删除<span class="token operator">|</span>创建子组件<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCcount</span><span class="token punctuation">(</span>count<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>点击<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
ReactDom<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="示例-模拟componentwillunmount"><a href="#示例-模拟componentwillunmount" class="header-anchor">#</a> 示例-模拟componentWillUnmount</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token comment">// 做清理工作</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="小结"><a href="#小结" class="header-anchor">#</a> 小结</h3> <p><strong>情况1</strong>：不带第二个参数。执行时机：初始执行，每次更新之后都要执行。</p> <p>模拟 componentDidmount + componentDidUpdate</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 副作用函数的内容</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>情况2</strong>：带第二个参数，参数是空数组。执行时机：只执行第一次。</p> <p>模拟 componentDidMount</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 副作用函数的内容</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>使用场景：1 事件绑定 2 发送请求获取数据 等。</p> <p><strong>情况3</strong>：带第二个参数（数组格式），并指定了依赖项。执行时机：（1）初始执行一次 （2）依赖项的值变化了，执行一次</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 副作用函数的内容</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>依赖项<span class="token number">1</span><span class="token punctuation">,</span>依赖项<span class="token number">2</span><span class="token punctuation">,</span><span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>这里的依赖项就是组件中定义的状态。</p> <p><strong>情况4</strong>：依赖项为空，没有具体的副作用函数，有副作用函数的清理函数</p> <p>模拟：componentWillUnMount</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  	<span class="token comment">// 副作用函数的清理函数，模拟 componentWillUnMount</span>
  <span class="token punctuation">}</span>
  
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="useeffect-清理副作用-案例"><a href="#useeffect-清理副作用-案例" class="header-anchor">#</a> useEffect-清理副作用-案例</h2> <h3 id="目标-2"><a href="#目标-2" class="header-anchor">#</a> 目标</h3> <p>掌握清理组件中定义的事件</p> <h3 id="问题导入"><a href="#问题导入" class="header-anchor">#</a> 问题导入</h3> <p>删除子组件之后，事件还有么？</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useEffect<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDom <span class="token keyword">from</span> <span class="token string">'react-dom'</span>

<span class="token keyword">function</span> <span class="token function">Com1</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mousemove'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>pageX<span class="token punctuation">,</span> e<span class="token punctuation">.</span>pageY<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>子组件<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isShow<span class="token punctuation">,</span> setIsShow<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>isShow <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>Com1 <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setIsShow</span><span class="token punctuation">(</span><span class="token operator">!</span>isShow<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>切换<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
ReactDom<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><p>子组件被删除了，但是，事件处理还在，所以要清理副作用。</p> <h3 id="解决"><a href="#解决" class="header-anchor">#</a> 解决</h3> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useEffect<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDom <span class="token keyword">from</span> <span class="token string">'react-dom'</span>

<span class="token keyword">function</span> <span class="token function">Com1</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>pageX<span class="token punctuation">,</span> e<span class="token punctuation">.</span>pageY<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token operator">+</span>    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mousemove'</span><span class="token punctuation">,</span> fn<span class="token punctuation">)</span>

<span class="token operator">+</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'mousemove'</span><span class="token punctuation">,</span> fn<span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'组件删除了'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">子组件</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isShow<span class="token punctuation">,</span> setIsShow<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>isShow <span class="token operator">&amp;&amp;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Com1</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setIsShow</span><span class="token punctuation">(</span><span class="token operator">!</span>isShow<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">切换</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
ReactDom<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">App</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="案例-鼠标跟随"><a href="#案例-鼠标跟随" class="header-anchor">#</a> 案例-鼠标跟随</h2> <h3 id="目标-3"><a href="#目标-3" class="header-anchor">#</a> 目标</h3> <p>能够实现案例，让图片跟随鼠标移动</p> <h3 id="思路"><a href="#思路" class="header-anchor">#</a> 思路</h3> <ul><li>通过useState提供状态</li> <li>通过useEffect给document注册鼠标移动事件</li> <li>在组件销毁的时候清理副作用</li></ul> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useEffect<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> img <span class="token keyword">from</span> <span class="token string">'./1.gif'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Move</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>position<span class="token punctuation">,</span> setPosition<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token function-variable function">move</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'移动'</span><span class="token punctuation">)</span>

      <span class="token function">setPosition</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">x</span><span class="token operator">:</span> e<span class="token punctuation">.</span>pageX<span class="token punctuation">,</span>
        <span class="token literal-property property">y</span><span class="token operator">:</span> e<span class="token punctuation">.</span>pageY
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mousemove'</span><span class="token punctuation">,</span> move<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'注册事件'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      document<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'mousemove'</span><span class="token punctuation">,</span> move<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span>
        <span class="token attr-name">src</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>img<span class="token punctuation">}</span></span>
        <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
          <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token string">'absolute'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">top</span><span class="token operator">:</span> position<span class="token punctuation">.</span>y <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token literal-property property">left</span><span class="token operator">:</span> position<span class="token punctuation">.</span>x <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
        <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
      <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="自定义hooks-应用场景"><a href="#自定义hooks-应用场景" class="header-anchor">#</a> 自定义hooks-应用场景</h2> <h3 id="目标-4"><a href="#目标-4" class="header-anchor">#</a> 目标</h3> <p>能够理解逻辑复用的含义</p> <h3 id="导入"><a href="#导入" class="header-anchor">#</a> 导入</h3> <p>目前还有另一功能，要跟踪鼠标的位置，并在页面上输出。</p> <p>仿写代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useEffect<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDom <span class="token keyword">from</span> <span class="token string">'react-dom'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>position<span class="token punctuation">,</span> setPosition<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token function-variable function">move</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'移动'</span><span class="token punctuation">)</span>

      <span class="token function">setPosition</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">x</span><span class="token operator">:</span> e<span class="token punctuation">.</span>pageX<span class="token punctuation">,</span>
        <span class="token literal-property property">y</span><span class="token operator">:</span> e<span class="token punctuation">.</span>pageY
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mousemove'</span><span class="token punctuation">,</span> move<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'注册事件'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      document<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'mousemove'</span><span class="token punctuation">,</span> move<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>position<span class="token punctuation">.</span>x<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>position<span class="token punctuation">.</span>y<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

ReactDom<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="思考"><a href="#思考" class="header-anchor">#</a> 思考</h3> <p>它与案例-鼠标跟随中的代码能否重用？</p> <h2 id="自定义hooks-实操"><a href="#自定义hooks-实操" class="header-anchor">#</a> 自定义hooks-实操</h2> <h3 id="定义"><a href="#定义" class="header-anchor">#</a> 定义</h3> <p>除了使用内置的 Hooks 之外，还可以创建自己的 Hooks（自定义 Hooks）。</p> <p>自定义 Hooks 针对不同组件实现不同状态<strong>逻辑复用</strong>。</p> <ul><li>自定义 Hooks 是一个函数，<strong>约定函数名称必须以 use 开头，React 就是通过函数名称是否以 use 开头来判断是不是 Hooks</strong></li> <li>Hooks 只能在函数组件中或其他自定义 Hooks 中使用，否则，会报错！</li> <li>自定义 Hooks 用来提取组件的状态逻辑，根据不同功能可以有不同的参数和返回值（就像使用普通函数一样）</li></ul> <h3 id="使用场景"><a href="#使用场景" class="header-anchor">#</a> 使用场景</h3> <p><strong>将组件状态逻辑提取到可重用的函数（自定义 Hooks）中，实现状态逻辑复用。</strong></p> <h3 id="核心代码"><a href="#核心代码" class="header-anchor">#</a> 核心代码</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// museMouse.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useEffect<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">useMouse</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 逻辑处理</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>position<span class="token punctuation">,</span> setPosition<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token function-variable function">move</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setPosition</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">x</span><span class="token operator">:</span> e<span class="token punctuation">.</span>pageX<span class="token punctuation">,</span>
        <span class="token literal-property property">y</span><span class="token operator">:</span> e<span class="token punctuation">.</span>pageY<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mousemove'</span><span class="token punctuation">,</span> move<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      document<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'mousemove'</span><span class="token punctuation">,</span> move<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  
  <span class="token comment">// 返回状态</span>
  <span class="token keyword">return</span> position
<span class="token punctuation">}</span>

</code></pre></div><h3 id="小结-2"><a href="#小结-2" class="header-anchor">#</a> 小结</h3> <ol><li>自定义hooks是一个____</li> <li>自定义hooks的名字必须以____开头</li> <li>自定义hooks只能在____和____中使用</li></ol> <h2 id="useref-操作dom"><a href="#useref-操作dom" class="header-anchor">#</a> useRef-操作DOM</h2> <h3 id="目标-5"><a href="#目标-5" class="header-anchor">#</a> 目标</h3> <p>能够使用useRef操作DOM</p> <h3 id="内容"><a href="#内容" class="header-anchor">#</a> 内容</h3> <p>使用场景：在 React 中进行 DOM 操作时，用来获取 DOM</p> <p>作用：<strong>返回一个带有 current 属性的可变对象，通过该对象就可以进行 DOM 操作了。</strong></p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> inputRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
</code></pre></div><p>解释：</p> <ul><li><p>参数：在获取 DOM 时，一般都设置为 null</p></li> <li><p>返回值：包含 current 属性的对象。</p></li> <li><p>注意：只要在 React 中进行 DOM 操作，都可以通过 useRef Hook 来获取 DOM（比如，获取 DOM 的宽高等）。</p></li> <li><p>注意：useRef不仅仅可以用于操作DOM，还可以操作组件</p></li></ul> <p><strong>核心代码：</strong></p> <div class="language-JSX extra-class"><pre class="language-jsx"><code><span class="token comment">// 1. 导入 useRef</span>
<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDom <span class="token keyword">from</span> <span class="token string">'react-dom'</span>

<span class="token keyword">class</span> <span class="token class-name">Com1</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">100</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">com1, </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>a<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 2. 调用useRef(初值),得到引用对象</span>
  <span class="token comment">// 3. 把引用对象设置ref 给任意的组件/元素</span>
  <span class="token comment">// 4. 通过引用对象.current 获取 组件/元素</span>
  <span class="token keyword">const</span> refTxt <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> refCom1 <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>refTxt<span class="token punctuation">)</span>

  <span class="token keyword">const</span> <span class="token function-variable function">click</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>refTxt<span class="token punctuation">,</span> refCom1<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>refCom1<span class="token punctuation">.</span>current<span class="token punctuation">.</span>state<span class="token punctuation">.</span>a<span class="token punctuation">)</span>
    <span class="token comment">// console.log(refTxt.current.value)</span>
    <span class="token comment">// refTxt.current.style.backgroundColor = 'red'</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      useRef, </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>refTxt<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">{</span><span class="token string">' '</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>click<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">点击，获取input中的值</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Com1</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>refCom1<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
ReactDom<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">App</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="useref-在多次渲染之间共享数据-停止定时器"><a href="#useref-在多次渲染之间共享数据-停止定时器" class="header-anchor">#</a> useRef-在多次渲染之间共享数据-停止定时器</h2> <p>函数组件虽然非常直观，简化了思考 UI 实现的逻辑，但是比起 Class 组件，还缺少了一个很重要的能力：在多次渲染之间共享数据。</p> <h3 id="目标-6"><a href="#目标-6" class="header-anchor">#</a> 目标</h3> <p>学习使用useRef在多次渲染之间共享数据</p> <h3 id="问题导入-2"><a href="#问题导入-2" class="header-anchor">#</a> 问题导入</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useEffect<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDom <span class="token keyword">from</span> <span class="token string">'react-dom'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> timeId <span class="token operator">=</span> <span class="token keyword">null</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>timeId<span class="token punctuation">)</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    timeId <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setCount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">count</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>timeId<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> <span class="token function-variable function">hClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>timeId<span class="token punctuation">)</span>
    <span class="token function">clearInterval</span><span class="token punctuation">(</span>timeId<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token literal-property property">count</span><span class="token operator">:</span><span class="token punctuation">{</span>count<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>hClick<span class="token punctuation">}</span><span class="token operator">&gt;</span>点击停止定时器<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
ReactDom<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="分析"><a href="#分析" class="header-anchor">#</a> 分析</h3> <p>setCount会导致组件重新渲染，而重新渲染时，会重复执行如下代码</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> timeId <span class="token operator">=</span> <span class="token keyword">null</span>
</code></pre></div><p>所以，无法保存timeId</p> <h3 id="思路-2"><a href="#思路-2" class="header-anchor">#</a> 思路</h3> <p>将timeId保存在一个多次渲染也不会丢失的位置。</p> <h3 id="步骤"><a href="#步骤" class="header-anchor">#</a> 步骤</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1. 导入 useRef</span>
<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token function">组件</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 2. 调用useRef，</span>
  <span class="token keyword">const</span> timeRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
  <span class="token comment">// 3. 向引用的current中存入数据</span>
  timeRef<span class="token punctuation">.</span>current <span class="token operator">=</span> 你需要在多次渲染之间共享的数据
<span class="token punctuation">}</span>
</code></pre></div><h3 id="解决-2"><a href="#解决-2" class="header-anchor">#</a> 解决</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useEffect<span class="token punctuation">,</span> useRef<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDom <span class="token keyword">from</span> <span class="token string">'react-dom'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> timeRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>timeRef<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    timeRef<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setCount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">count</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>timeRef<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> <span class="token function-variable function">hClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>timeRef<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
    <span class="token function">clearInterval</span><span class="token punctuation">(</span>timeRef<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token literal-property property">count</span><span class="token operator">:</span><span class="token punctuation">{</span>count<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>hClick<span class="token punctuation">}</span><span class="token operator">&gt;</span>点击停止定时器<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
ReactDom<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="自定义hooks-封装倒计时-需求-验证码"><a href="#自定义hooks-封装倒计时-需求-验证码" class="header-anchor">#</a> 自定义hooks-封装倒计时-需求-验证码</h2> <h3 id="目标-7"><a href="#目标-7" class="header-anchor">#</a> 目标</h3> <p>写代码完成效果</p> <p>描述：点击按钮：按钮不可用，开始倒计时10秒，10秒结束之后，按钮恢复可用</p> <h3 id="思路-3"><a href="#思路-3" class="header-anchor">#</a> 思路</h3> <ol><li>定义两个state:
<ol><li>canSend: 初始为true，倒计时期间为false，绑定给按钮的 disabled属性</li> <li>count： 初始为0，点击按钮之后count置为60，绑定给文字</li></ol></li> <li>点击按钮之后：
<ol><li>canSend改成false</li> <li>开启定时器setInterval</li></ol></li></ol> <h3 id="基本实现"><a href="#基本实现" class="header-anchor">#</a> 基本实现</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect<span class="token punctuation">,</span> useRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">import</span> ReactDom <span class="token keyword">from</span> <span class="token string">'react-dom'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 多次渲染之间共享数据：定时器</span>
  <span class="token keyword">const</span> timeId <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
  
  <span class="token keyword">const</span> <span class="token punctuation">[</span>canSend<span class="token punctuation">,</span> setCanSend<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>initCount<span class="token punctuation">)</span>

  <span class="token keyword">const</span> <span class="token function-variable function">send</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setCanSend</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token function">setCount</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
    timeId<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setCount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">count</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'..........'</span><span class="token punctuation">)</span>
      <span class="token function">clearInterval</span><span class="token punctuation">(</span>timeId<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> timeId<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">clearInterval</span><span class="token punctuation">(</span>timeId<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
        <span class="token comment">// 倒计时结束</span>
        <span class="token comment">// 恢复按钮可用</span>
        <span class="token function">setCanSend</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>count<span class="token punctuation">]</span>
  <span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button disabled<span class="token operator">=</span><span class="token punctuation">{</span><span class="token operator">!</span>canSend<span class="token punctuation">}</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span>send<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token punctuation">{</span>canSend <span class="token operator">?</span> <span class="token string">'发送验证码'</span> <span class="token operator">:</span> count <span class="token operator">+</span> <span class="token string">'秒之后再发送'</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
ReactDom<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="自定义hooks-封装倒计时-需求-404页面3秒跳转"><a href="#自定义hooks-封装倒计时-需求-404页面3秒跳转" class="header-anchor">#</a> 自定义hooks-封装倒计时-需求-404页面3秒跳转</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/* eslint-disable react-hooks/exhaustive-deps */</span>
<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect<span class="token punctuation">,</span> useRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDom <span class="token keyword">from</span> <span class="token string">'react-dom'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> refTimerId <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1. 开始倒数</span>
    <span class="token function">setCount</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token comment">// 2. 启动</span>
    refTimerId<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setCount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">count</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'观察到count变了'</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//    倒数结束，要:</span>
        <span class="token comment">// 1. 跳转</span>
        location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">'http://www.baidu.com'</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'location.href = http://www.baidu.com'</span><span class="token punctuation">)</span>
        <span class="token comment">// 2.清空定时器</span>
        <span class="token function">clearInterval</span><span class="token punctuation">(</span>refTimerId<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>count<span class="token punctuation">]</span>
  <span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      你要的页面不存在，<span class="token punctuation">{</span>count<span class="token punctuation">}</span>秒之后，自动跳到主页。或者点击<span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;http://www.baidu.com&quot;</span><span class="token operator">&gt;</span>这里<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>跳转
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

ReactDom<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="自定义hooks-封装倒计时-提炼hooks"><a href="#自定义hooks-封装倒计时-提炼hooks" class="header-anchor">#</a> 自定义hooks-封装倒计时-提炼hooks</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">useCountDown</span> <span class="token punctuation">(</span>initCount <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token function-variable function">callBack</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> timeId <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>initCount<span class="token punctuation">)</span>

  <span class="token keyword">const</span> <span class="token function-variable function">start</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setCount</span><span class="token punctuation">(</span>initCount<span class="token punctuation">)</span>
    timeId<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setCount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">count</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'..........'</span><span class="token punctuation">)</span>
      <span class="token function">clearInterval</span><span class="token punctuation">(</span>timeId<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> timeId<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">clearInterval</span><span class="token punctuation">(</span>timeId<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
        <span class="token function">callBack</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>count<span class="token punctuation">]</span>
  <span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> count<span class="token punctuation">,</span> start <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="完整功能"><a href="#完整功能" class="header-anchor">#</a> 完整功能</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect<span class="token punctuation">,</span> useRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">import</span> ReactDom <span class="token keyword">from</span> <span class="token string">'react-dom'</span>

<span class="token keyword">import</span> useCountDown <span class="token keyword">from</span> <span class="token string">'./useCountDown'</span> <span class="token comment">// 引入hooks</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> count<span class="token punctuation">,</span> start <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useCountDown</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setCanSend</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>canSend<span class="token punctuation">,</span> setCanSend<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> <span class="token function-variable function">send</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setCanSend</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token function">start</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button disabled<span class="token operator">=</span><span class="token punctuation">{</span><span class="token operator">!</span>canSend<span class="token punctuation">}</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span>send<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token punctuation">{</span>canSend <span class="token operator">?</span> <span class="token string">'发送验证码'</span> <span class="token operator">:</span> count <span class="token operator">+</span> <span class="token string">'秒之后再发送'</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
ReactDom<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="usecontext-全局状态"><a href="#usecontext-全局状态" class="header-anchor">#</a> useContext-全局状态</h2> <h3 id="目标-8"><a href="#目标-8" class="header-anchor">#</a> 目标</h3> <p>掌握useContext的使用</p> <h3 id="目标-9"><a href="#目标-9" class="header-anchor">#</a> 目标</h3> <p><img src="data:image/png;base64,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" alt="image-20211009091931455"></p> <h3 id="基础素材"><a href="#基础素材" class="header-anchor">#</a> 基础素材</h3> <p>目录</p> <div class="language-bash extra-class"><pre class="language-bash"><code>- index.js   <span class="token comment"># 根组件，包含father  </span>
- father.js  <span class="token comment"># 父组件，包含son</span>
- son.js     <span class="token comment"># 子组件</span>
</code></pre></div><p>index.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> Father <span class="token keyword">from</span> <span class="token string">'./father'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>color<span class="token punctuation">,</span> setColor<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token literal-property property">border</span><span class="token operator">:</span><span class="token string">'1px solid #ccc'</span><span class="token punctuation">,</span> <span class="token literal-property property">margin</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
            <span class="token literal-property property">根组件</span><span class="token operator">:</span>color<span class="token operator">:</span><span class="token punctuation">{</span>color<span class="token punctuation">}</span>
            <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token function">setColor</span><span class="token punctuation">(</span><span class="token string">'green'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>改成 green<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>

            <span class="token operator">&lt;</span>Father <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>father.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Son <span class="token keyword">from</span> <span class="token string">'./son.js'</span>
<span class="token keyword">const</span> <span class="token function-variable function">Father</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token literal-property property">border</span><span class="token operator">:</span><span class="token string">'1px solid #ccc'</span><span class="token punctuation">,</span> <span class="token literal-property property">margin</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
        父组件
        <span class="token operator">&lt;</span>Son<span class="token operator">/</span><span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Father
</code></pre></div><p>son.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">Son</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token literal-property property">border</span><span class="token operator">:</span><span class="token string">'1px solid #ccc'</span><span class="token punctuation">,</span> <span class="token literal-property property">margin</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
        子组件： color<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string">'red'</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Son
</code></pre></div><h3 id="usecontext步骤"><a href="#usecontext步骤" class="header-anchor">#</a> useContext步骤</h3> <p>共3步：</p> <ol><li><p>导入并调用createContext方法，得到Context对象，导出</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> Context <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>使用 <strong>Provider</strong> 组件<strong>包裹根组件</strong>，并通过 <strong>value</strong> 属性提供要共享的数据</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">return</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>Context<span class="token punctuation">.</span>Provider value<span class="token operator">=</span><span class="token punctuation">{</span> 这里放要传递的数据 <span class="token punctuation">}</span><span class="token operator">&gt;</span>
  	<span class="token operator">&lt;</span>根组件的内容<span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">&gt;</span>
<span class="token punctuation">)</span>
</code></pre></div></li> <li><p>在任意后代组件中，如果希望获取公共数据：</p> <p>导入useContext；调用useContext(第一步中导出的context) 得到value的值</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Context <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./index'</span>
<span class="token keyword">const</span> <span class="token function-variable function">函数组件</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> 公共数据 <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>Context<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span> 函数组件的内容 <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <h3 id="完成目标"><a href="#完成目标" class="header-anchor">#</a> 完成目标</h3> <p>index.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> Father <span class="token keyword">from</span> <span class="token string">'./father'</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> Context <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">//  这里有导出</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>color<span class="token punctuation">,</span> setColor<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>Context<span class="token punctuation">.</span>Provider value<span class="token operator">=</span><span class="token punctuation">{</span>color<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token literal-property property">border</span><span class="token operator">:</span><span class="token string">'1px solid #ccc'</span><span class="token punctuation">,</span> <span class="token literal-property property">margin</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
            <span class="token literal-property property">根组件</span><span class="token operator">:</span>color<span class="token operator">:</span><span class="token punctuation">{</span>color<span class="token punctuation">}</span>
            <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token function">setColor</span><span class="token punctuation">(</span><span class="token string">'green'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>改成 green<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>

            <span class="token operator">&lt;</span>Father <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>Context<span class="token punctuation">.</span>Provider<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>father.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Son <span class="token keyword">from</span> <span class="token string">'./son.js'</span>
<span class="token keyword">const</span> <span class="token function-variable function">Father</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token literal-property property">border</span><span class="token operator">:</span><span class="token string">'1px solid #ccc'</span><span class="token punctuation">,</span> <span class="token literal-property property">margin</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
        父组件
        <span class="token operator">&lt;</span>Son<span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Father
</code></pre></div><p>son.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Context <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./index'</span>
<span class="token keyword">const</span> <span class="token function-variable function">Son</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> color <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>Context<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token literal-property property">border</span><span class="token operator">:</span><span class="token string">'1px solid #ccc'</span><span class="token punctuation">,</span> <span class="token literal-property property">margin</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
        子组件： color<span class="token operator">:</span> <span class="token punctuation">{</span>color<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Son
</code></pre></div><h2 id="购物车案例-发送请求-获取列表数据"><a href="#购物车案例-发送请求-获取列表数据" class="header-anchor">#</a> 购物车案例-发送请求-获取列表数据</h2> <h3 id="目标-10"><a href="#目标-10" class="header-anchor">#</a> 目标</h3> <p>发送请求，获取到购物车数据</p> <h3 id="步骤-2"><a href="#步骤-2" class="header-anchor">#</a> 步骤</h3> <ol><li>安装axios</li> <li>使用useState hooks提供状态</li> <li>使用useEffect发送请求获取数据</li></ol> <h3 id="核心代码-2"><a href="#核心代码-2" class="header-anchor">#</a> 核心代码</h3> <ul><li>安装axios</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">yarn</span> <span class="token function">add</span> axios
</code></pre></div><ul><li>发送请求，获取数据</li></ul> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 判断本地是否有数据</span>
  <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">setList</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 本地没有数据，发送请求，获取数据</span>
  <span class="token keyword">const</span> <span class="token function-variable function">getList</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'https://www.escook.cn/api/cart'</span><span class="token punctuation">)</span>
    <span class="token function">setList</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>list<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">getList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="mycount组件的封装-基本结构"><a href="#mycount组件的封装-基本结构" class="header-anchor">#</a> MyCount组件的封装-基本结构</h2> <ul><li>基本结构</li></ul> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token string">'./index.scss'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">MyCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>my-counter<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-light<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        -
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>number<span class="token punctuation">&quot;</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control inp<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-light<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        +
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><ul><li>样式</li></ul> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token selector">.my-counter </span><span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token selector">.inp </span><span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 45px<span class="token punctuation">;</span>
    <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 0 10px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><ul><li>在GoodsItem组件中渲染</li></ul> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> MyCount <span class="token keyword">from</span> <span class="token string">'../MyCount'</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">MyCount</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">MyCount</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="数量控制-usecontext"><a href="#数量控制-usecontext" class="header-anchor">#</a> 数量控制-useContext</h2> <h3 id="目标-11"><a href="#目标-11" class="header-anchor">#</a> 目标</h3> <p>使用useContext优化组件的通讯，完成数量的修改</p> <h3 id="步骤-3"><a href="#步骤-3" class="header-anchor">#</a> 步骤</h3> <ol><li>在App.js中创建Context对象，并且导出</li></ol> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">export</span> <span class="token keyword">const</span> Context <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ol start="2"><li>在App.js中，通过Provider提供方法 changeCount</li></ol> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect<span class="token punctuation">,</span> createContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDom <span class="token keyword">from</span> <span class="token string">'react-dom'</span>
<span class="token keyword">import</span> GoodsItem <span class="token keyword">from</span> <span class="token string">'./components/GoodsItem/GoodsItem'</span>
<span class="token keyword">import</span> MyFooter <span class="token keyword">from</span> <span class="token string">'./components/MyFooter/MyFooter'</span>
<span class="token keyword">import</span> MyHeader <span class="token keyword">from</span> <span class="token string">'./components/MyHeader/MyHeader'</span>
<span class="token keyword">import</span> <span class="token string">'bootstrap/dist/css/bootstrap.css'</span>
<span class="token keyword">import</span> <span class="token string">'./app.scss'</span>
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> Context <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// const initList = [</span>
<span class="token comment">//   {</span>
<span class="token comment">//     id: 1,</span>
<span class="token comment">//     goods_name: '班俏BANQIAO超火ins潮卫衣女士2020秋季新款韩版宽松慵懒风薄款外套带帽上衣',</span>
<span class="token comment">//     goods_img: 'https://www.escook.cn/vuebase/pics/1.png',</span>
<span class="token comment">//     goods_price: 108,</span>
<span class="token comment">//     goods_count: 1,</span>
<span class="token comment">//     goods_state: true</span>
<span class="token comment">//   },</span>
<span class="token comment">//   {</span>
<span class="token comment">//     id: 2,</span>
<span class="token comment">//     goods_name: '嘉叶希连帽卫衣女春秋薄款2020新款宽松bf韩版字母印花中长款外套ins潮',</span>
<span class="token comment">//     goods_img: 'https://www.escook.cn/vuebase/pics/2.png',</span>
<span class="token comment">//     goods_price: 129,</span>
<span class="token comment">//     goods_count: 1,</span>
<span class="token comment">//     goods_state: true</span>
<span class="token comment">//   },</span>
<span class="token comment">//   {</span>
<span class="token comment">//     id: 3,</span>
<span class="token comment">//     goods_name: '思蜜怡2020休闲运动套装女春秋季新款时尚大码宽松长袖卫衣两件套',</span>
<span class="token comment">//     goods_img: 'https://www.escook.cn/vuebase/pics/3.png',</span>
<span class="token comment">//     goods_price: 198,</span>
<span class="token comment">//     goods_count: 1,</span>
<span class="token comment">//     goods_state: false</span>
<span class="token comment">//   },</span>
<span class="token comment">//   {</span>
<span class="token comment">//     id: 4,</span>
<span class="token comment">//     goods_name: '思蜜怡卫衣女加绒加厚2020秋冬装新款韩版宽松上衣连帽中长款外套',</span>
<span class="token comment">//     goods_img: 'https://www.escook.cn/vuebase/pics/4.png',</span>
<span class="token comment">//     goods_price: 99,</span>
<span class="token comment">//     goods_count: 1,</span>
<span class="token comment">//     goods_state: false</span>
<span class="token comment">//   },</span>
<span class="token comment">//   {</span>
<span class="token comment">//     id: 5,</span>
<span class="token comment">//     goods_name: '幂凝早秋季卫衣女春秋装韩版宽松中长款假两件上衣薄款ins盐系外套潮',</span>
<span class="token comment">//     goods_img: 'https://www.escook.cn/vuebase/pics/5.png',</span>
<span class="token comment">//     goods_price: 156,</span>
<span class="token comment">//     goods_count: 1,</span>
<span class="token comment">//     goods_state: true</span>
<span class="token comment">//   },</span>
<span class="token comment">//   {</span>
<span class="token comment">//     id: 6,</span>
<span class="token comment">//     goods_name: 'ME&amp;CITY女装冬季新款针织抽绳休闲连帽卫衣女',</span>
<span class="token comment">//     goods_img: 'https://www.escook.cn/vuebase/pics/6.png',</span>
<span class="token comment">//     goods_price: 142.8,</span>
<span class="token comment">//     goods_count: 1,</span>
<span class="token comment">//     goods_state: true</span>
<span class="token comment">//   },</span>
<span class="token comment">//   {</span>
<span class="token comment">//     id: 7,</span>
<span class="token comment">//     goods_name: '幂凝假两件女士卫衣秋冬女装2020年新款韩版宽松春秋季薄款ins潮外套',</span>
<span class="token comment">//     goods_img: 'https://www.escook.cn/vuebase/pics/7.png',</span>
<span class="token comment">//     goods_price: 219,</span>
<span class="token comment">//     goods_count: 2,</span>
<span class="token comment">//     goods_state: true</span>
<span class="token comment">//   },</span>
<span class="token comment">//   {</span>
<span class="token comment">//     id: 8,</span>
<span class="token comment">//     goods_name: '依魅人2020休闲运动衣套装女秋季新款秋季韩版宽松卫衣 时尚两件套',</span>
<span class="token comment">//     goods_img: 'https://www.escook.cn/vuebase/pics/8.png',</span>
<span class="token comment">//     goods_price: 178,</span>
<span class="token comment">//     goods_count: 1,</span>
<span class="token comment">//     goods_state: true</span>
<span class="token comment">//   },</span>
<span class="token comment">//   {</span>
<span class="token comment">//     id: 9,</span>
<span class="token comment">//     goods_name: '芷臻(zhizhen)加厚卫衣2020春秋季女长袖韩版宽松短款加绒春秋装连帽开衫外套冬',</span>
<span class="token comment">//     goods_img: 'https://www.escook.cn/vuebase/pics/9.png',</span>
<span class="token comment">//     goods_price: 128,</span>
<span class="token comment">//     goods_count: 1,</span>
<span class="token comment">//     goods_state: false</span>
<span class="token comment">//   },</span>
<span class="token comment">//   {</span>
<span class="token comment">//     id: 10,</span>
<span class="token comment">//     goods_name: 'Semir森马卫衣女冬装2019新款可爱甜美大撞色小清新连帽薄绒女士套头衫',</span>
<span class="token comment">//     goods_img: 'https://www.escook.cn/vuebase/pics/10.png',</span>
<span class="token comment">//     goods_price: 153,</span>
<span class="token comment">//     goods_count: 1,</span>
<span class="token comment">//     goods_state: false</span>
<span class="token comment">//   }</span>
<span class="token comment">// ]</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'渲染APP....'</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> <span class="token punctuation">[</span>list<span class="token punctuation">,</span> setList<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token comment">//   const [list, setList] = useState(</span>
  <span class="token comment">//     JSON.parse(localStorage.getItem('list')) || initList</span>
  <span class="token comment">//   )</span>

  <span class="token comment">//   console.log(list, setList)</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'保存list'</span><span class="token punctuation">)</span>
      localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>list<span class="token punctuation">]</span>
  <span class="token punctuation">)</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 判断本地是否有数据</span>
    <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">setList</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 本地没有数据，发送请求，获取数据</span>
    <span class="token keyword">const</span> <span class="token function-variable function">getList</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'https://www.escook.cn/api/cart'</span><span class="token punctuation">)</span>
      <span class="token function">setList</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>list<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">getList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token comment">// 找到id为 id的商品，设置它的状态为 newState</span>
  <span class="token keyword">const</span> <span class="token function-variable function">setGoodSelectState</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> newState</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> newState<span class="token punctuation">)</span> <span class="token comment">// 1 false</span>
    <span class="token keyword">const</span> newList <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">it</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>it<span class="token punctuation">.</span>id <span class="token operator">===</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>it<span class="token punctuation">,</span> <span class="token literal-property property">goods_state</span><span class="token operator">:</span> newState <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>it <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">setList</span><span class="token punctuation">(</span>newList<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 找到id为 id的商品，设置它的状态为 newState</span>
  <span class="token keyword">const</span> <span class="token function-variable function">setGoodCount</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> newCount</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> newCount<span class="token punctuation">)</span> <span class="token comment">// 1 false</span>
    <span class="token keyword">const</span> newList <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">it</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>it<span class="token punctuation">.</span>id <span class="token operator">===</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>it<span class="token punctuation">,</span> <span class="token literal-property property">goods_count</span><span class="token operator">:</span> newCount <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>it <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">setList</span><span class="token punctuation">(</span>newList<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 把所有的商品全部改成newState</span>
  <span class="token keyword">const</span> <span class="token function-variable function">setCheckAll</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">newState</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> newList <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">it</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>it<span class="token punctuation">,</span> <span class="token literal-property property">goods_state</span><span class="token operator">:</span> newState <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">setList</span><span class="token punctuation">(</span>newList<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Context.Provider</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> setGoodCount <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">MyHeader</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">

        </span><span class="token punctuation">{</span>list<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">goods</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">GoodsItem</span></span>
              <span class="token attr-name">setGoodSelectState</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>setGoodSelectState<span class="token punctuation">}</span></span>
              <span class="token attr-name">goods</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>goods<span class="token punctuation">}</span></span>
              <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>goods<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span>
            <span class="token punctuation">/&gt;</span></span>
          <span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">

        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">MyFooter</span></span> <span class="token attr-name">list</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>list<span class="token punctuation">}</span></span> <span class="token attr-name">setCheckAll</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>setCheckAll<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Context.Provider</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
ReactDom<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">App</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><ol start="3"><li>在myCount组件中，使用useContext获取数据</li></ol> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">/* eslint-disable react/prop-types */</span>
<span class="token comment">/* eslint-disable no-unused-vars */</span>
<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Context <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../App'</span>
<span class="token keyword">import</span> <span class="token string">'./index.scss'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">MyCount</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> goods <span class="token punctuation">}</span> <span class="token operator">=</span> props
  <span class="token keyword">const</span> <span class="token punctuation">{</span> setGoodCount <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>Context<span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>my-counter<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
        <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-light<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setGoodCount</span><span class="token punctuation">(</span>goods<span class="token punctuation">.</span>id<span class="token punctuation">,</span> goods<span class="token punctuation">.</span>goods_count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        -
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
        <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>number<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control inp<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>goods<span class="token punctuation">.</span>goods_count<span class="token punctuation">}</span></span>
      <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
        <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-light<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setGoodCount</span><span class="token punctuation">(</span>goods<span class="token punctuation">.</span>id<span class="token punctuation">,</span> goods<span class="token punctuation">.</span>goods_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        +
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="拓展-使用-eslint-插件帮助检查-hooks-的使用"><a href="#拓展-使用-eslint-插件帮助检查-hooks-的使用" class="header-anchor">#</a> 拓展-使用 ESLint 插件帮助检查 Hooks 的使用</h2> <p>刚才你已经看到了使用 Hooks 的一些特性和要遵循的规则，那么应用到日常的开发中，就必须时刻注意不能写错。</p> <p>包括这么三点：</p> <ul><li><p>在 useEffect 的回调函数中使用的变量，都必须在依赖项中声明；</p></li> <li><p>Hooks 不能出现在条件语句或者循环中，也不能出现在 return 之后；</p></li> <li><p>Hooks 只能在函数组件或者自定义 Hooks 中使用。</p></li></ul> <p>React 官方为我们提供了一个 ESLint 的插件，专门用来检查 Hooks 是否正确被使用，它就是 eslint-plugin-react-hooks 。通过这个插件，如果发现缺少依赖项定义这样违反规则的情况，就会报一个错误提示（类似于语法错误的提示），方便进行修改，从而避免 Hooks 的错误使用。</p> <h3 id="使用步骤"><a href="#使用步骤" class="header-anchor">#</a> 使用步骤</h3> <ol><li><p>安装这个插件：<code>npm install eslint-plugin-react-hooks -D</code></p></li> <li><p>修改：ESLint 配置文件。</p> <p>加入两个规则：rules-of-hooks 和 exhaustive-deps。如下：</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// ...</span>
    <span class="token string">&quot;react-hooks&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;rules&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token comment">// 检查 Hooks 的使用规则</span>
    <span class="token string-property property">&quot;react-hooks/rules-of-hooks&quot;</span><span class="token operator">:</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span> 
    <span class="token comment">// 检查依赖项的声明</span>
    <span class="token string-property property">&quot;react-hooks/exhaustive-deps&quot;</span><span class="token operator">:</span> <span class="token string">&quot;warn&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/jiely/chapter1/05-react-hooks基础.html" class="prev">
        React Hooks
      </a></span> <span class="next"><a href="/jiely/chapter1/07-redux基础.html">
        Redux基本介绍
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/jiely/assets/js/app.87156db4.js" defer></script><script src="/jiely/assets/js/3.05e47443.js" defer></script><script src="/jiely/assets/js/29.28bb402e.js" defer></script>
  </body>
</html>
